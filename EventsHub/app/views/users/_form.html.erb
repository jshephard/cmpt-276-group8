<%= form_for @user, html: {id: 'user_form', :'data-type' => 'json'}, remote: true do |f| %>
    <div id="error_explanation">
    <% if @user.errors.any? %>
      <h2><%= pluralize(@user.errors.count, "error") %> prohibited this user from registering:</h2>

      <ul>
        <% @user.errors.full_messages.each do |message| %>
            <li><%= message %></li>
        <% end %>
      </ul>
    <% end %>
    </div>

    <div class="field">
      <%= f.label :username %><br>
      <%= f.text_field :username %>
    </div>
    <% if logged_in? # so it's explicit in the user editor it's a new password %>
        <div class="field">
          <%= f.label "New Password" %><br>
          <%= f.password_field :password %>
        </div>
        <div class="field">
          <%= f.label "Confirm New Password" %><br>
          <%= f.password_field :password_confirmation %>
        </div>
        <% unless current_user.is_administrator? %>
        <div class="field">
          <%= f.label "Old Password" %><br>
          <%= f.password_field :old_password %>
        </div>
        <% end %>
    <% else %>
        <div class="field">
          <%= f.label :password %><br>
          <%= f.password_field :password %>
        </div>
        <div class="field">
          <%= f.label :password_confirmation %><br>
          <%= f.password_field :password_confirmation %>
        </div>
    <% end %>
    <div class="field">
      <%= f.label :email %><br>
      <%= f.email_field :email %>
    </div>
    <div class="field">
      <%= f.label :first_name %><br>
      <%= f.text_field :first_name %>
    </div>
    <div class="field">
      <%= f.label :last_name %><br>
      <%= f.text_field :last_name %>
    </div>
    <div class="field">
      <%= f.label :date_of_birth %><br>
      <%= f.date_select :date_of_birth, :start_year => Date.current.year, :end_year => 1900 %>
    </div>
    <div class="actions">
      <%= f.submit value: button_name %>
    </div>
<% end %>
